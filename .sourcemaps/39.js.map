{"version":3,"sources":["../../src/pages/home/home.module.ts","../../src/pages/home/home.ts"],"names":[],"mappings":"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","file":"39.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { HomePage } from './home';\n\n@NgModule({\n  declarations: [\n    HomePage,\n  ],\n  imports: [\n    IonicPageModule.forChild(HomePage),\n  ],\n  exports: [\n    HomePage\n  ]\n})\nexport class HomePageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/home/home.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, ModalController, LoadingController } from 'ionic-angular';\n\nimport { DbService } from '../../services/db.service';\nimport { AngularFireAuth } from 'angularfire2/auth';\nimport { iPosition } from '../../interfaces/position.interface';\n// import { Geolocation } from '@ionic-native/geolocation';\nimport { GmapService } from '../../services/gmap.service';\nimport { ShopService } from '../../services/shop.service';\nimport { LocalService } from '../../services/local.service';\n// import * as firebase from 'firebase/app';\n\nimport { iShop } from '../../interfaces/shop.interface';\n\n@IonicPage()\n@Component({\n  selector: 'page-home',\n  templateUrl: 'home.html',\n})\nexport class HomePage {\n  USER_LOCATION: iPosition;\n  USER_LAST_TIME: string;\n  USER_ID = null;\n  IMG = '../../assets/imgs/menugo_144x144.png';\n  SHOPS_ID: any[] = [];\n  SHOPS_LOCATION: any[] = [];\n  loading: any;\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    private modalCtrl: ModalController,\n    private loadingCtrl: LoadingController,\n    private dbService: DbService,\n    private afAuth: AngularFireAuth,\n    // private geolocation: Geolocation,\n    private gmapService: GmapService,\n    private shopService: ShopService,\n    private localService: LocalService\n  ) {\n    this.loading = this.loadingCtrl.create({\n      content: 'Please wait....',\n      spinner: 'crescent'\n    });\n    \n    // // this.test();\n    // if (this.afAuth.auth.currentUser) {\n    //   this.USER_ID = this.afAuth.auth.currentUser.uid;\n    // }\n    this.startLoading();\n    this.gmapService.getUserCurrentPosition()\n    .then((pos: iPosition)=>{\n      this.USER_LOCATION = pos;\n      this.getShopsNearby(this.USER_LOCATION.lat, this.USER_LOCATION.lng);\n    })\n    .catch((err)=>{\n      console.log(err);\n      this.hideLoading();\n      // alert(err);\n    })\n    // this.geolocation.getCurrentPosition()\n    //   .then((res) => {\n    //     console.log(res);\n    //     this.USER_LOCATION = {\n    //       lat: res.coords.latitude,\n    //       lng: res.coords.longitude\n    //     };\n    //     this.gmapService.setUserCurrentPosition(this.USER_LOCATION);\n    //     this.getShopsNearby(this.USER_LOCATION.lat, this.USER_LOCATION.lng);\n    //   })\n    //   .catch((err) => {\n    //     console.log(err);\n    //     if (this.USER_ID) {\n    //       let UID = this.USER_ID;\n    //       this.dbService.getOneItemReturnPromise('UserPosition/' + UID)\n    //         .then((res: any) => {\n    //           this.USER_LOCATION = res.LAST_POSITION;\n    //           this.USER_LAST_TIME = res.TIME;\n    //           console.log(res);\n    //           this.getShopsNearby(this.USER_LOCATION.lat, this.USER_LOCATION.lng);\n    //         })\n    //         .catch((err) => {\n    //           this.USER_LOCATION = { lat: 10.778168043677463, lng: 106.69638633728027 };\n    //           this.getShopsNearby(this.USER_LOCATION.lat, this.USER_LOCATION.lng);\n    //           this.gmapService.setUserCurrentPosition(this.USER_LOCATION);\n    //           alert('Cannot detect your location. Allow location detect to enable feature. Thanks');\n    //         })\n    //     }else{\n    //       console.log('user not login');\n    //       this.USER_LOCATION = { lat: 10.778168043677463, lng: 106.69638633728027 };\n    //       this.getShopsNearby(this.USER_LOCATION.lat, this.USER_LOCATION.lng);\n    //       this.gmapService.setUserCurrentPosition(this.USER_LOCATION);\n    //       alert('Cannot detect your location. Allow location detect to enable feature. Thanks');\n    //     }\n    //   })\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad HomePage');\n    // this.startLoading();\n  }\n\n  go2MapPage() {\n    let data = {\n      USER_LOCATION: this.USER_LOCATION,\n      SHOPS_ID: this.SHOPS_ID,\n      SHOPS_LOCATION: this.SHOPS_LOCATION\n    }\n    this.navCtrl.setRoot('MapPage', data);\n  }\n\n  getShopsNearby(LAT: number, LNG: number) {\n    \n    if (!this.localService.SHOP_LOADED) {\n      this.shopService.getShopsNearBy(LAT, LNG)\n        .then((res: any) => {\n          console.log(res);\n          this.SHOPS_ID = res.SHOP_IDs;\n          this.SHOPS_LOCATION = res.SHOP_locations;\n          this.localService.SHOPs_LOCATION = res.SHOP_locations;\n          this.localService.SHOPs_NEARBY = res.SHOP_IDs;\n          this.localService.SHOP_LOADED = true;\n          this.shopService.getShopsInDetail(res.SHOP_IDs);\n          this.hideLoading();\n        })\n        .catch((err) => {\n          console.log(err)\n          this.hideLoading();\n          this.localService.SHOP_LOADED = false;\n        })\n    }else{\n      console.log('Shop list already loaded');\n      this.hideLoading();\n    }\n    // this.shopService.getShops(LAT, LNG);\n  }\n\n  go2SearchShop() {\n    let modal = this.modalCtrl.create('SearchShopPage');\n    modal.onDidDismiss((data)=>{\n      console.log(data);\n      if(typeof(data) !== 'undefined'){\n        this.go2Shop(data.SHOP);\n      }\n    })\n    modal.present();\n  }\n\n  go2Shop(shop: iShop) {\n    console.log(shop.SHOP_OTHER);\n    if('SHOP_OTHER' in shop){\n      console.log(shop.SHOP_OTHER);\n\n      // if isVERIFIED exist\n      if('isVERIFIED' in shop.SHOP_OTHER){\n        if(shop.SHOP_OTHER.isVERIFIED){\n          console.log('isVERIFIED TRUE');\n          this.navCtrl.setRoot('Shop2Page', { SHOP: shop });\n        }else{\n          console.log('isVERIFIED FALSE');\n          this.navCtrl.setRoot('Shop1Page', { SHOP: shop });\n        }\n      }else{\n        console.log('isVERIFIED not exist');\n        this.navCtrl.setRoot('Shop1Page', { SHOP: shop });\n      }\n    }else{\n      console.log('no SHOP_OTHER')\n      this.navCtrl.setRoot('Shop1Page', { SHOP: shop });\n    }\n  }\n\n  go2ListPage(){\n    let data = {\n      USER_LOCATION: this.USER_LOCATION,\n      SHOPS_ID: this.SHOPS_ID,\n      SHOPS_LOCATION: this.SHOPS_LOCATION\n    }\n    this.navCtrl.setRoot('ListPage', data);\n  }\n\n  startLoading() {\n    this.loading.present();\n    setTimeout(() => {\n      this.hideLoading();\n      // alert('Please turn on internet and location permission. Then open app again')\n    }, 15000)\n  }\n\n  hideLoading() {\n    this.loading.dismiss().catch((err) => { console.log(err) });\n  }\n\n}\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/home/home.ts"],"sourceRoot":""}