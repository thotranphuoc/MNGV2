{"version":3,"sources":["../../src/pages/mapx/mapx.module.ts","../../src/pages/mapx/mapx.ts"],"names":[],"mappings":"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","file":"33.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { MapxPage } from './mapx';\n\n@NgModule({\n  declarations: [\n    MapxPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(MapxPage),\n  ],\n})\nexport class MapxPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/mapx/mapx.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, LoadingController, ViewController } from 'ionic-angular';\nimport { GmapService } from '../../services/gmap.service';\n\nimport { DbService } from '../../services/db.service';\nimport { iPosition } from '../../interfaces/position.interface';\nimport { iShop } from '../../interfaces/shop.interface';\ndeclare var google: any;\n@IonicPage({\n  name: 'mapx-page',\n  segment: 'mapx/:id'\n})\n@Component({\n  selector: 'page-mapx',\n  templateUrl: 'mapx.html',\n})\nexport class MapxPage {\n  data: any;\n  mapEl: any;\n  map: any;\n  directionsService: any;\n  directionsDisplay: any;\n  DISTANCE: number = 0;\n  loading: any;\n  userMarker: any;\n  // CURRENT_LOCATION: iPosition = null;\n  SHOP: iShop;\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    private loadingCtrl: LoadingController,\n    private viewCtrl: ViewController,\n    private gmapService: GmapService,\n    private dbService: DbService,\n  ) {\n    this.loading = this.loadingCtrl.create({\n      content: 'Please wait....',\n      spinner: 'crescent'\n    });\n    // this.startLoading();\n    let shopId = this.navParams.get('id');\n    console.log('id: ', shopId);\n    this.getShop(shopId);\n  }\n\n  getShop(SHOP_ID) {\n    this.startLoading();\n    this.dbService.getOneItemReturnPromise('Shops/' + SHOP_ID)\n      .then((SHOP: iShop) => {\n        this.hideLoading();\n        this.SHOP = SHOP;\n        // this.go2Shop(SHOP);\n        // this.CURRENT_LOCATION = this.SHOP.SHOP_LOCATION;\n        this.startLoadMap();\n      })\n      .catch((err) => {\n        console.log(err);\n        this.hideLoading();\n      })\n  }\n\n  startLoadMap() {\n    // console.log('ionViewDidLoad LocationPage');\n    this.startLoading();\n    setTimeout(() => {\n      this.mapEl = document.getElementById('map');\n      this.initMap(this.mapEl)\n    }, 1000)\n  }\n\n  initMap(mapElement) {\n    console.log('start initMap()')\n    if (this.SHOP.SHOP_LOCATION) {\n      console.log('user location set');\n      console.log(this.SHOP.SHOP_LOCATION)\n      this.showMap(this.SHOP.SHOP_LOCATION, mapElement);\n    } else {\n      console.log('user location not set yet');\n      this.gmapService.getUserCurrentPosition()\n        .then((pos: iPosition) => {\n          console.log(pos);\n          this.showMap(pos, mapElement);\n        })\n        .catch((err) => {\n          console.log(err);\n        })\n    }\n  }\n\n  showMap(position: iPosition, mapElement) {\n    let latLng = new google.maps.LatLng(position.lat, position.lng);\n    let mapOptions = {\n      center: latLng,\n      zoom: 15,\n      mapTypeId: google.maps.MapTypeId.ROADMAP,\n      mapTypeControl: false,\n      zoomControl: false,\n      fullscreenControl: false\n    }\n\n    console.log(mapElement, mapOptions);\n    this.gmapService.initMap(mapElement, mapOptions)\n      .then((map) => {\n        // this.hideLoading();\n        console.log(map);\n        this.map = map;\n        // when maps is loaded and become idle\n        google.maps.event.addListener(this.map, 'idle', () => {\n          console.log('map was loaded fully');\n\n          this.hideLoading();\n\n          this.gmapService.getUserCurrentPosition()\n            .then((pos) => {\n              console.log(pos);\n              this.gmapService.drawDirection(this.map, pos, mapOptions.center)\n              .then((res: any)=>{\n                console.log(res);\n                this.DISTANCE = res.DISTANCE;\n              })\n              .catch((err)=>{ console.log(err); });\n              this.gmapService.addBlueDotToMap(this.map, pos);\n              // this.gmapService.addMarkerToMapWithIDReturnPromiseWithMarker(this.map, this.SHOP.SHOP_LOCATION, this.SHOP)\n              //   .then((res) => { console.log(res) })\n              //   .catch((err) => { console.log(err) });\n            })\n            .catch((err) => { console.log(err) });\n          console.log(this.SHOP);\n        })\n      })\n      .catch((err) => { console.log(err); })\n  }\n\n  go2Shop() {\n    let shop = this.SHOP;\n    console.log(shop.SHOP_OTHER);\n    if('SHOP_OTHER' in shop){\n      console.log(shop.SHOP_OTHER);\n\n      // if isVERIFIED exist\n      if('isVERIFIED' in shop.SHOP_OTHER){\n        if(shop.SHOP_OTHER.isVERIFIED){\n          console.log('isVERIFIED TRUE');\n          this.navCtrl.setRoot('Shop2Page', { SHOP: shop });\n        }else{\n          console.log('isVERIFIED FALSE');\n          this.navCtrl.setRoot('Shop1Page', { SHOP: shop });\n        }\n      }else{\n        console.log('isVERIFIED not exist');\n        this.navCtrl.setRoot('Shop1Page', { SHOP: shop });\n      }\n    }else{\n      console.log('no SHOP_OTHER')\n      this.navCtrl.setRoot('Shop1Page', { SHOP: shop });\n    }\n  }\n\n  private startLoading() {\n    this.loading.present();\n    setTimeout(() => {\n      this.hideLoading();\n      // alert('Please turn on internet and location permission. Then open app again')\n    }, 15000)\n  }\n\n  private hideLoading() {\n    this.loading.dismiss()\n      .then((res) => { console.log(res) })\n      .catch((err) => { console.log(err) });\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/mapx/mapx.ts"],"sourceRoot":""}