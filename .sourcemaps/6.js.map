{"version":3,"sources":["../../src/pages/shop2-order/shop2-order.module.ts","../../src/pages/shop2-order/shop2-order.ts"],"names":[],"mappings":"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","file":"6.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { Shop2OrderPage } from './shop2-order';\n\n@NgModule({\n  declarations: [\n    Shop2OrderPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(Shop2OrderPage),\n  ],\n})\nexport class Shop2OrderPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/shop2-order/shop2-order.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, ViewController } from 'ionic-angular';\n\nimport { AngularFireService } from '../../services/af.service';\nimport { AppService } from '../../services/app.service';\nimport { DbService } from '../../services/db.service';\nimport { CrudService } from '../../services/crud.service';\n\nimport { iItem } from '../../interfaces/item.interface';\nimport { iOrderList } from '../../interfaces/order-list.interface';\nimport { iOrder } from '../../interfaces/order.interface';\n@IonicPage()\n@Component({\n  selector: 'page-shop2-order',\n  templateUrl: 'shop2-order.html',\n})\nexport class Shop2OrderPage {\n  ORDER: iOrder;\n  SHOP_ITEMS: iItem[] = [];\n  SHOP_ITEMS_ID: string[] = [];\n  SHOP_ITEMS_INDEX: any[] = [];\n  // SHOP_ITEMS_INDEX_TEMP: any[] =[];\n  isOrderNEW: boolean = true;\n  isOrderUPDATE: boolean = false;\n  // isItemNEW: boolean = true;\n  // isItemUPDATE: boolean = false;\n  data: any;\n  ACTION: string = null;\n  TOTAL: number = 0;\n  COUNT: number = 0;\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    private viewCtrl: ViewController,\n    private crudService: CrudService,\n    private appService: AppService,\n    private dbService: DbService,\n    private afService: AngularFireService\n  ) {\n    this.data = this.navParams.data;\n    this.SHOP_ITEMS = this.data.SHOP_ITEMS\n    this.SHOP_ITEMS_ID = this.data.SHOP_ITEMS_ID;\n    this.SHOP_ITEMS_INDEX = this.data.SHOP_ITEMS_INDEX;\n    // this.SHOP_ITEMS_INDEX_TEMP = this.data.SHOP_ITEMS_INDEX;\n    this.isOrderNEW = this.data.isOrderNEW;\n    this.isOrderUPDATE = this.data.isOrderUPDATE;\n    this.ORDER = this.data.ORDER;\n    this.ACTION = this.data.ACTION;\n    this.COUNT = this.data.COUNT;\n    console.log(this.data);\n    this.calTotal();\n  }\n\n  calTotal(){\n    this.TOTAL = 0;\n    this.SHOP_ITEMS.forEach((element, index) => {\n      this.TOTAL += element.ITEM_PRICE*this.SHOP_ITEMS_INDEX[index].count\n    });\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad Shop2OrderPage');\n  }\n\n  subtract(i: number) {\n    this.COUNT--;\n    if (this.SHOP_ITEMS_INDEX[i]) {\n      this.SHOP_ITEMS_INDEX[i].count--;\n    }\n    // this.checkItemNEWorUPDATE()\n    this.checkOrderIfUpdated();\n  }\n\n  add(i: number) {\n    this.COUNT++\n    // this.itemIndex[i].count++;\n    this.SHOP_ITEMS_INDEX[i].count++;\n    // this.checkItemNEWorUPDATE();\n\n    this.checkOrderIfUpdated();\n  }\n\n  sendORDER() {\n    let ORDER_LIST: iOrderList[] = [];\n    this.SHOP_ITEMS_INDEX.forEach((element, index: number, array) => {\n      if (element.count > 0) {\n        ORDER_LIST.push({ item: this.SHOP_ITEMS[index].ITEM_ID, amount: element.count });\n      }\n    });\n    console.log(ORDER_LIST);\n    let SHOP_ID = this.SHOP_ITEMS[0].ITEM_SHOP_ID;\n    let USER_ID = this.afService.getAuth().auth.currentUser != null ? this.afService.getAuth().auth.currentUser.uid : null;\n    let DATETIME = this.appService.getCurrentDataAndTime();\n    let TABLE = 'T01';\n    this.ORDER = {\n      ORDER_ID: null,\n      ORDER_SHOP_ID: SHOP_ID,\n      ORDER_USER_ID: USER_ID,\n      ORDER_STAFT_ID: USER_ID,\n      ORDER_STATUS: 'SENDING',\n      ORDER_DATE_CREATE: DATETIME,\n      ORDER_DATE_CLOSE: null,\n      ORDER_TABLE: TABLE,\n      ORDER_LIST: ORDER_LIST,\n    };\n    let DATE = this.appService.getCurrentDate();\n    if (USER_ID) {\n      this.crudService.createOrder(this.ORDER, SHOP_ID, USER_ID, DATE)\n        .then((res: any) => {\n          console.log(res);\n          this.isOrderNEW = false;\n          this.closeModal();\n        })\n        .catch((err) => {\n          console.log(err);\n        })\n      // this.localService.sendNewOrder(ORDER, SHOP_ID, USER_ID, DATE);\n      // this.Order2Update = ORDER;\n      // this.resetIndex();\n    } else {\n      alert('Please sign in to continue');\n      this.navCtrl.push('AccountPage', { action: 'request-login' });\n    }\n  }\n\n  updateOrder(){\n    let ORDER_LIST: iOrderList[] = [];\n    this.SHOP_ITEMS_INDEX.forEach((element, index: number, array) => {\n      if (element.count > 0) {\n        ORDER_LIST.push({ item: this.SHOP_ITEMS[index].ITEM_ID, amount: element.count });\n      }\n    });\n    console.log(ORDER_LIST);\n    // this.dbService.getOneItemReturnPromise()\n    this.crudService.updateOrder(ORDER_LIST, this.ORDER).then((res)=>{\n      console.log(res);\n      this.isOrderUPDATE = false;\n      this.closeModal();\n    }).catch((err)=>{\n      console.log(err);\n    })\n  }\n\n  closeModal() {\n    // this.viewCtrl.dismiss();\n    let data = {\n      SHOP_ITEMS: this.SHOP_ITEMS,\n      SHOP_ITEMS_ID: this.SHOP_ITEMS_ID,\n      SHOP_ITEMS_INDEX: this.SHOP_ITEMS_INDEX,\n      isOrderNEW: this.isOrderNEW,\n      isOrderUPDATE: this.isOrderUPDATE,\n      ORDER: this.ORDER,\n      COUNT: this.COUNT\n      \n    }\n    this.viewCtrl.dismiss(data);\n  }\n\n  cancel() {\n    // this.SHOP_ITEMS_INDEX = this.SHOP_ITEMS_INDEX_TEMP;\n    console.log(this.SHOP_ITEMS_INDEX);\n    this.closeModal();\n  }\n\n  // checkItemNEWorUPDATE() {\n  //   let count: number = 0;\n  //   this.SHOP_ITEMS_INDEX.forEach(item => {\n  //     count += item.count;\n  //   })\n  //   if (count > 0 && !this.isItemUPDATE) {\n  //     this.isItemNEW = true;\n  //   } else if (count > 0 && this.isItemUPDATE) {\n  //     this.isItemNEW = false;\n  //   }\n  //   console.log(this.isItemNEW, this.isItemUPDATE);\n  // }\n\n  checkOrderIfUpdated() {\n    let count: number = 0;\n    this.SHOP_ITEMS_INDEX.forEach(item => {\n      count += item.count;\n    })\n    if (count > 0 && !this.isOrderNEW) {\n      this.isOrderUPDATE = true;\n    } else {\n      this.isOrderUPDATE = false;\n    }\n  }\n\n  checkBill(){\n    console.log('check bill');\n    this.closeModal();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/shop2-order/shop2-order.ts"],"sourceRoot":""}