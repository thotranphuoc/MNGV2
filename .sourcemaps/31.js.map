{"version":3,"sources":["../../src/pages/add-new-shop-tab4/add-new-shop-tab4.module.ts","../../src/pages/add-new-shop-tab4/add-new-shop-tab4.ts"],"names":[],"mappings":"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","file":"31.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { AddNewShopTab4Page } from './add-new-shop-tab4';\n\n@NgModule({\n  declarations: [\n    AddNewShopTab4Page,\n  ],\n  imports: [\n    IonicPageModule.forChild(AddNewShopTab4Page),\n  ],\n  exports: [\n    AddNewShopTab4Page\n  ]\n})\nexport class AddNewShopTab4PageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-new-shop-tab4/add-new-shop-tab4.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, LoadingController, App, AlertController } from 'ionic-angular';\n\nimport { AppService } from '../../services/app.service';\nimport { LocalService } from '../../services/local.service';\nimport { GmapService } from '../../services/gmap.service';\nimport { AngularFireService } from '../../services/af.service';\nimport { DbService } from '../../services/db.service';\nimport { CrudService } from '../../services/crud.service';\n\nimport { iShop } from '../../interfaces/shop.interface';\nimport { iPosition } from '../../interfaces/position.interface';\n\ndeclare var google: any;\n\n@IonicPage()\n@Component({\n  selector: 'page-add-new-shop-tab4',\n  templateUrl: 'add-new-shop-tab4.html',\n})\nexport class AddNewShopTab4Page {\n  SHOP_IMAGES: string[] = null;\n  SHOP: iShop;\n  mapreview: any;\n  mapElement: any;\n  loading: any;\n\n  // Review & post\n  isInfoFullFilled: boolean = true;\n  hasPosted: boolean = false;\n\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    private loadingCtrl: LoadingController,\n    private app: App,\n    private alertCtrl: AlertController,\n    private appService: AppService,\n    private afService: AngularFireService,\n    private gmapService: GmapService,\n    private localService: LocalService,\n    private crudService: CrudService,\n    private dbService: DbService) {\n    this.SHOP = this.localService.SHOP;\n    this.loading = this.loadingCtrl.create({\n      content: 'Please wait....',\n      spinner: 'crescent'\n    });\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad AddNewShopTab4Page');\n  }\n\n  ionViewWillEnter() {\n    this.SHOP_IMAGES = this.localService.SHOP_IMAGES;\n    this.SHOP = this.localService.SHOP;\n    console.log(this.localService.SHOP.SHOP_LOCATION);\n\n    setTimeout(() => {\n      if (this.SHOP.SHOP_LOCATION) {\n        this.initMap(this.SHOP.SHOP_LOCATION)\n      } else {\n        this.initMap({ lat: 0, lng: 0 })\n      }\n    }, 1000)\n  }\n\n  initMap(position: iPosition) {\n    let mapElement = document.getElementById('mapreview');\n    let latLng = new google.maps.LatLng(position.lat, position.lng);\n    let mapOption = {\n      center: latLng,\n      zoom: 15,\n      mapTypeId: google.maps.MapTypeId.ROADMAP\n    }\n    this.gmapService.initMap(mapElement, mapOption)\n      .then((map) => {\n        this.mapreview = map;\n        this.gmapService.addMarkerToMap(this.mapreview, position).then((marker) => {\n        })\n      })\n  }\n\n  createShop() {\n    this.hasPosted = true;\n    console.log(this.SHOP);\n    this.checkInfoFullFilled();\n    if (this.isInfoFullFilled) {\n      if (this.afService.getAuth().auth.currentUser) {\n        // user signed in\n        this.SHOP.SHOP_OWNER = this.afService.getAuth().auth.currentUser.uid;\n        this.SHOP.SHOP_DATE_CREATE = this.appService.getCurrentDataAndTime().toString();\n        console.log(this.SHOP);\n        this.addNewShop(this.SHOP, this.SHOP_IMAGES);\n      } else {\n        // user not signed in yet\n        this.hasPosted = false;\n        this.alertMsgWithConfirmationToGoToPage();\n      }\n    } else {\n      this.appService.alertMsg('Error', 'info not full filled')\n    }\n  }\n\n  addNewShop(SHOP: iShop, images: string[]) {\n    this.crudService.createNewShop(SHOP, images)\n      .then((res) => {\n        console.log(res);\n        this.hideLoading();\n        this.resetShop();\n        this.go2Page('MapPage');\n      })\n      .catch((err) => {\n        console.log(err);\n        this.appService.alertError('Error', err.toString())\n        this.hasPosted = false;\n      })\n  }\n\n  alertMsgWithConfirmationToGoToPage() {\n    this.alertCtrl.create({\n      title: 'Not Signed',\n      message: 'Plz login to continue',\n      buttons: [\n        {\n          text: 'Cancel',\n          handler: () => {\n\n          }\n        },\n        {\n          text: 'OK',\n          handler: () => {\n            console.log('go to Account page to login ');\n            // this.navCtrl.popToRoot();\n            this.navCtrl.push('AccountPage', { action: 'request-login' });\n          }\n        }\n      ]\n    }).present();\n  }\n\n  checkInfoFullFilled() {\n    this.isInfoFullFilled = true;\n    if (this.SHOP.SHOP_NAME == null || this.SHOP.SHOP_NAME == '') {\n      this.isInfoFullFilled = false;\n      console.log(this.SHOP.SHOP_NAME, ' is missed');\n    }\n    if (this.SHOP.SHOP_ADDRESS == null || this.SHOP.SHOP_ADDRESS == '') {\n      this.isInfoFullFilled = false;\n      console.log(this.SHOP.SHOP_ADDRESS, ' is missed');\n    }\n\n    if (this.SHOP_IMAGES == null) {\n      this.isInfoFullFilled = false;\n      console.log(this.SHOP.SHOP_NAME, 'image is missed');\n    }\n\n    console.log(this.SHOP.SHOP_NAME);\n    console.log(this.SHOP.SHOP_ADDRESS);\n    console.log(this.isInfoFullFilled, '<--isInfoFullfilled?');\n  }\n\n  // LOADING\n  private startLoading() {\n    this.loading.present();\n    setTimeout(() => {\n      this.hideLoading();\n      // alert('Please turn on internet and location permission. Then open app again')\n    }, 20000)\n  }\n\n  private hideLoading() {\n    this.loading.dismiss();\n  }\n\n  private hideLoadingWithMessage(message: string) {\n    this.loading.dismiss();\n    this.appService.alertMsg('Alert', message);\n    this.go2Page('MapPage')\n  }\n\n  go2Page(page: string) {\n    const root = this.app.getRootNav();\n    root.setRoot(page);\n  }\n\n  resetShop() {\n    this.localService.SHOP = this.localService.SHOP_DEFAULT;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-new-shop-tab4/add-new-shop-tab4.ts"],"sourceRoot":""}