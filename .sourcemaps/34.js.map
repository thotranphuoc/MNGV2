{"version":3,"sources":["../../src/pages/image-upload/image-upload.module.ts","../../src/pages/image-upload/image-upload.ts"],"names":[],"mappings":"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","file":"34.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ImageUploadPage } from './image-upload';\n\n@NgModule({\n  declarations: [\n    ImageUploadPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(ImageUploadPage),\n  ],\n})\nexport class ImageUploadPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/image-upload/image-upload.module.ts","import { Component } from '@angular/core';\nimport {\n  IonicPage, NavController, NavParams,\n  ViewController\n} from 'ionic-angular';\n\nimport { ImageService } from '../../services/image.service';\nimport { DbService } from '../../services/db.service';\nimport { CrudService } from '../../services/crud.service';\nimport { LocalService } from '../../services/local.service';\nimport { iImage } from '../../interfaces/image.interface';\n@IonicPage()\n@Component({\n  selector: 'page-image-upload',\n  templateUrl: 'image-upload.html',\n})\nexport class ImageUploadPage {\n  data: any;\n  ACTION: string = 'New Image';\n  IMAGE: iImage = null;\n  isNEW: boolean = false;\n  isNEW2Update: boolean = false;\n  KEY: string = null;\n\n  // base64Images: string[] = [];\n  // base64ImagesThumbnail: string[] = [];\n  imageURL: any = null;\n  thumbnailURL: any = null;\n\n  // newPhoto: boolean = false;\n  // image = { IMG_KEYWORD: null }\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    private viewCtrl: ViewController,\n    private imageService: ImageService,\n    private dbService: DbService,\n    private crudService: CrudService,\n    private localService: LocalService\n  ) {\n    this.data = this.navParams.data;\n    this.ACTION = this.data.ACTION;\n    this.IMAGE = typeof (this.data.IMAGE) === 'undefined' ? null : this.data.IMAGE;\n    this.KEY = typeof (this.data.KEY) === 'undefined' ? null : this.data.KEY;\n    if (!this.IMAGE || !this.KEY) {\n      this.IMAGE = this.localService.IMAGE_DEFAULT;\n      this.isNEW = true;\n    }\n    // this.base64Images = this.data.PHOTOS;\n    console.log(this.data, this.ACTION, this.IMAGE, this.KEY);\n    // if (typeof (this.base64Images) === 'undefined') {\n    //   this.base64Images = [];\n    // }\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad PhotosTakePage');\n  }\n\n  takePhoto() {\n    this.selectPhotoByBrowser();\n  }\n\n  selectPhotoByBrowser() {\n    console.log('start browsering or taking photo camera')\n    document.getElementById('inputFile').click();\n  }\n\n  takePictureAndResizeByBrowser(event) {\n    // this.base64ImagesThumbnail = [];\n    // this.base64Images = [];\n    // FOR THUMBNAIL\n    let pro1 = this.imageService.resizeImagesFromChoosenFilesReturnPromiseWithArrayOfImageDataUrlsSizeSetable(event, 150, 150)\n      .then((imgDataUrls: string[]) => {\n        setTimeout(() => {\n          console.log(imgDataUrls);\n          // this.base64ImagesThumbnail = imgDataUrls;\n          this.IMAGE.THUM_URL = imgDataUrls[0];\n        }, 2000)\n      })\n      .catch((err) => console.log(err))\n\n    // FOR NORMAL IMG\n    let pro2 = this.imageService.resizeImagesFromChoosenFilesReturnPromiseWithArrayOfImageDataUrlsSizeSetable(event, 750, 750)\n      .then((imgDataUrls: string[]) => {\n        setTimeout(() => {\n          console.log(imgDataUrls);\n          // this.base64Images = imgDataUrls;\n          this.IMAGE.IMG_URL = imgDataUrls[0];\n        }, 2000)\n      })\n      .catch((err) => console.log(err))\n    Promise.all([pro1, pro2]).then(() => {\n      this.isNEW2Update = true;\n    })\n      .catch((err) => {\n        console.log(err);\n        this.isNEW2Update = false;\n      })\n  }\n\n\n  doCancel() {\n    this.dismiss(true, this.IMAGE);\n  }\n\n  startUploadUpdate() {\n    console.log(this.IMAGE);\n    if (!this.IMAGE.IMG_KEYWORD || !this.IMAGE.IMG_URL || !this.IMAGE.THUM_URL) {\n      console.log('Info missing');\n      alert('Information missing');\n    } else {\n      console.log('full filled');\n      let pre = this.IMAGE.IMG_URL.substr(0, 4);\n      if (pre === 'data') {\n        console.log('new image to upload');\n        this.uploadImage(this.KEY);\n      }\n    }\n  }\n\n  startUploadNew() {\n    if (!this.IMAGE.IMG_KEYWORD || !this.IMAGE.IMG_URL || !this.IMAGE.THUM_URL) {\n      console.log('Info missing');\n      alert('Information missing');\n    } else {\n      console.log('full filled');\n      this.createImage();\n    }\n  }\n\n  createImage() {\n    console.log(this.imageURL, this.thumbnailURL);\n    let IMAGE = {\n      IMG_URL: this.imageURL,\n      THUM_URL: this.thumbnailURL,\n      IMG_KEYWORD: this.IMAGE.IMG_KEYWORD\n    }\n    this.crudService.createImage(IMAGE)\n      .then((res) => {\n        console.log(res);\n        let KEY = res.key;\n        // alert('database update done');\n        this.uploadImage(KEY);\n      })\n      .catch((err) => { console.log(err); });\n  }\n\n  uploadImage(KEY) {\n    let PATH = 'SharedImages';\n    // let IMAGE = this.base64Images[0];\n    let IMAGE = this.IMAGE.IMG_URL;\n    let PATH_THUM = 'ThumbImages'\n    // let THUMBNAIL = this.base64ImagesThumbnail[0];\n    let THUMBNAIL = this.IMAGE.THUM_URL;\n    // let NAME = Date.now().toString();\n    let pro1 = this.dbService.uploadBase64Image2FBReturnPromiseWithURL(PATH, IMAGE, KEY)\n      .then((res: any) => {\n        console.log(res);\n        this.imageURL = res;\n      })\n      .catch((err) => { console.log(err); });\n    let pro2 = this.dbService.uploadBase64Image2FBReturnPromiseWithURL(PATH_THUM, THUMBNAIL, KEY)\n      .then((res1) => {\n        console.log(res1);\n        this.thumbnailURL = res1;\n      })\n      .catch((err) => { console.log(err); });\n\n    return Promise.all([pro1, pro2])\n      .then((res) => {\n        console.log('images uploaded successfully');\n        this.updateDB(KEY);\n      })\n      .catch((err) => {\n        console.log('Something went wrong', err);\n      })\n  }\n\n  updateDB(KEY) {\n    // start update database\n    console.log(this.imageURL, this.thumbnailURL);\n    let IMAGE = {\n      IMG_URL: this.imageURL,\n      THUM_URL: this.thumbnailURL,\n      IMG_KEYWORD: this.IMAGE.IMG_KEYWORD\n    }\n    this.crudService.updateImage(IMAGE, KEY)\n      .then((res) => {\n        console.log(res);\n        this.dismiss(false, IMAGE);\n        alert('database update done');\n\n      })\n      .catch((err) => { console.log(err); });\n  }\n\n  dismiss(isCancel, IMAGE) {\n    this.viewCtrl.dismiss({ isCancel: isCancel, IMAGE: IMAGE })\n      .then((res) => { console.log(res) })\n      .catch((err) => { console.log(err) })\n  }\n\n\n}\n\n// export interface iImage {\n//   IMG_URL: string,\n//   THUM_URL: string,\n//   IMG_KEYWORD: string\n// }\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/image-upload/image-upload.ts"],"sourceRoot":""}