{"version":3,"sources":["../../src/pages/location/location.module.ts","../../src/pages/location/location.ts"],"names":[],"mappings":"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","file":"35.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { LocationPage } from './location';\n\n@NgModule({\n  declarations: [\n    LocationPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(LocationPage),\n  ],\n  exports: [\n    LocationPage\n  ]\n})\nexport class LocationPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/location/location.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, LoadingController, ViewController } from 'ionic-angular';\nimport { GmapService } from '../../services/gmap.service';\nimport { iPosition } from '../../interfaces/position.interface';\ndeclare var google: any;\n@IonicPage()\n@Component({\n  selector: 'page-location',\n  templateUrl: 'location.html',\n})\nexport class LocationPage {\n  data: any;\n  loading: any;\n  mapEl: any;\n  map: any;\n  userMarker: any;\n  CURRENT_LOCATION: iPosition = null;\n  NEW_SELECTED_LOCATION: iPosition = null;\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    private loadingCtrl: LoadingController,\n    private viewCtrl: ViewController,\n    private gmapService: GmapService,\n  ) {\n    this.data = this.navParams.data;\n    console.log(this.data);\n    this.CURRENT_LOCATION = this.data.CURRENT_LOCATION;\n    this.loading = this.loadingCtrl.create({\n      content: 'Please wait....',\n      spinner: 'crescent'\n    });\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad LocationPage');\n    this.startLoading();\n    setTimeout(() => {\n      this.mapEl = document.getElementById('map');\n      this.initMap(this.mapEl)\n    }, 1000)\n  }\n\n  initMap(mapElement) {\n    console.log('start initMap()')\n    if (this.CURRENT_LOCATION) {\n      console.log('user location set');\n      console.log(this.CURRENT_LOCATION)\n      this.showMap(this.CURRENT_LOCATION, mapElement);\n    } else {\n      console.log('user location not set yet');\n      this.gmapService.getUserCurrentPosition()\n        .then((pos: iPosition) => {\n          console.log(pos);\n          this.showMap(pos, mapElement);\n        })\n        .catch((err) => {\n          console.log(err);\n        })\n    }\n  }\n\n\n  showMap(position: iPosition, mapElement) {\n    let latLng = new google.maps.LatLng(position.lat, position.lng);\n    let mapOptions = {\n      center: latLng,\n      zoom: 15,\n      mapTypeId: google.maps.MapTypeId.ROADMAP,\n      mapTypeControl: false,\n      zoomControl: false,\n      fullscreenControl: false\n    }\n\n    console.log(mapElement, mapOptions);\n    this.gmapService.initMap(mapElement, mapOptions)\n      .then((map) => {\n        this.hideLoading();\n        console.log(map);\n        this.map = map;\n        // when maps is loaded and become idle\n        google.maps.event.addListener(this.map, 'idle', () => {\n          console.log('map was loaded fully');\n          this.hideLoading();\n          this.gmapService.addMarkerToMap(this.map, position).then((marker) => {\n            this.userMarker = marker;\n            this.NEW_SELECTED_LOCATION = position;\n          });\n        })\n\n        google.maps.event.addListener(this.map, 'click', (event) => {\n          this.userMarker.setMap(null);\n          let positionClick = { lat: event.latLng.lat(), lng: event.latLng.lng() }\n          console.log(positionClick);\n          this.userMarker = new google.maps.Marker({\n            position: positionClick,\n            map: this.map\n          })\n          this.NEW_SELECTED_LOCATION = positionClick;\n        })\n\n      })\n      .catch((err) => { console.log(err); })\n  }\n\n  setLocation() {\n    let NEW_LOCATION = {\n      lat: Number(this.NEW_SELECTED_LOCATION.lat.toFixed(5)),\n      lng: Number(this.NEW_SELECTED_LOCATION.lng.toFixed(5))\n    }\n    console.log(NEW_LOCATION);\n    // this.viewCtrl.dismiss({ NEW_LOCATION: this.NEW_SELECTED_LOCATION })\n    this.viewCtrl.dismiss({ NEW_LOCATION: NEW_LOCATION })\n      .then((res) => { console.log(res) })\n      .catch((err) => { console.log(err) });\n  }\n\n  cancelLocation() {\n    this.viewCtrl.dismiss({ NEW_LOCATION: this.CURRENT_LOCATION })\n      .then((res) => { console.log(res) })\n      .catch((err) => { console.log(err) });\n  }\n\n  private startLoading() {\n    this.loading.present();\n    setTimeout(() => {\n      this.hideLoading();\n      // alert('Please turn on internet and location permission. Then open app again')\n    }, 15000)\n  }\n\n  private hideLoading() {\n    this.loading.dismiss()\n      .then((res) => { console.log(res) })\n      .catch((err) => { console.log(err) });\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/location/location.ts"],"sourceRoot":""}